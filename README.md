Service for authentication and authorization.

TODOS:
1) Extract test to a separate module so we can share fixtures instead of copypasting.
2) Write more tests for api
